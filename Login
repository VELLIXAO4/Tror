
if not gg then os.exit() end
gg.setVisible(false)

-- üå∏ File UID dan banned
local uidFile = "/sdcard/Android/.gg_vellix_device_uid.txt"
local banFile = "/sdcard/Android/.gg_vellix_banned_uid.txt"

-- üîí Ambil UID
local function getUID()
  local f = io.open(uidFile, "r")
  if f then
    local uid = f:read("*l")
    f:close()
    return uid
  end
end

local uid = getUID()
if not uid then
  gg.alert("‚ùå UID tidak ditemukan!\nHarap generate UID terlebih dahulu.")
  os.exit()
end

-- üõë Cek apakah UID dibanned
local function isBanned(uid)
  local f = io.open(banFile, "r")
  if f then
    for line in f:lines() do
      if line == uid then
        f:close()
        return true
      end
    end
    f:close()
  end
  return false
end

if isBanned(uid) then
  gg.alert("üö´ Akses ditolak!\nUID ini telah diblokir karena modifikasi script.")
  os.exit()
end

-- ‚ö†Ô∏è Jika modifikasi terdeteksi, simpan UID ke daftar banned
local function banUID(uid)
  local f = io.open(banFile, "a")
  if f then
    f:write(uid .. "\n")
    f:close()
  end
end

-- üïµÔ∏è‚Äç‚ôÄÔ∏è Cek modifikasi script (self-check)
local function integrityCheck()
  local thisFile = debug.getinfo(1, "S").source:sub(2)
  local f = io.open(thisFile, "r")
  if not f then return end
  local content = f:read("*all")
  f:close()

  local critical = {
    "firebaseURL",
    "gg.makeRequest",
    "script_url",
    "load(run.content)()"
  }

  for _, key in ipairs(critical) do
    if not content:find(key, 1, true) then
      banUID(uid)
      gg.alert("‚ùå Script telah dimodifikasi!\nUID ini sekarang diblokir permanen.")
      os.exit()
    end
  end
end

-- üöß Jalankan check
integrityCheck()

--üå∏ Vellix UID Auth System | Kawaii Edition üê∞‚ú®
if not gg then os.exit() end
gg.setVisible(false)

local uidFile = "/sdcard/Android/.gg_vellix_device_uid.txt"

--üêæ Ambil UID dari file lokal
local function getUID()
  local f = io.open(uidFile, "r")
  if f then
    local uid = f:read("*l")
    f:close()
    return uid
  end
end

local uid = getUID()
if not uid then
  gg.alert("üö´ Eeehh... UID-nya ga ketemu nih! (>Ôπè<)\n\nüéÄ Coba generate UID dulu ya~")
  os.exit()
end

gg.toast("üêá Halo UID~ ‚ú®\n" .. uid)
gg.sleep(1300)
gg.toast("üå∏ Lagi nyambung ke server Panel yaa~ üçì")
gg.sleep(1600)

--üåê Firebase Master_Log URL
local firebaseURL = "https://iruna-afd77-default-rtdb.asia-southeast1.firebasedatabase.app/Master_Log/"..uid..".json"
local res = gg.makeRequest(firebaseURL)

if not res or res.code ~= 200 or not res.content or res.content == "null" then
  gg.alert("üòø UID kamu belum terdaftar di server...\n\n‚ú® Hubungi admin cantik dulu ya~")
  os.exit()
end

--üìñ Ambil data dari JSON
local json = res.content
local banned  = json:match('"banned"%s*:%s*"([^"]+)"')
local expired = json:match('"expired"%s*:%s*"([^"]+)"')
local password = json:match('"password"%s*:%s*"([^"]+)"')
local script_url = json:match('"script_url"%s*:%s*"([^"]+)"')

--üîí Cek status banned
if banned == "true" then
  gg.alert("üö´ Aaaa~ UID ini dibanned üò≠\n\nüíå Minta tolong admin yaa~")
  os.exit()
end

--üìÖ Cek tanggal kedaluwarsa
local today = os.date("%Y-%m-%d")
if expired and expired < today then
  gg.alert("‚õî Huhuhu... Akses kamu udah expired sejak: " .. expired .. " üò¢")
  os.exit()
end

--üßÅ Password Prompt
local input = gg.prompt(
  {"üíñ Yuk masukin password kamu, UID-nya:\n" .. uid .. " üß∏"}, 
  nil, 
  {"text"}
)

if not input or input[1] ~= password then
  gg.alert("üö´ Password-nya salah dong~ (>_<)\n\nüìû Hubungi admin yuk~")
  os.exit()
end

--‚ú® Verifikasi berhasil uwu~
gg.toast("üåà Password benar! Siip~ ü©µ")
gg.sleep(1000)
gg.toast("üç∞ Tunggu yaa... lagi ambil script-nya dulu ‚ú®")
gg.sleep(1600)

--üì• Ambil dan jalankan script utama
local run = gg.makeRequest(script_url or "")
if not run or run.code ~= 200 or not run.content then
  gg.alert("üò≠ Ehh~ gagal ambil script-nya...\nCoba periksa koneksi kamu yaa~ üåßÔ∏è")
  os.exit()
end

gg.toast("üåü Script berhasil dimuat~ nyaaa üíï")
gg.sleep(1000)

--ü¶Ñ Jalankan isi script utama dari server~
load(run.content)()
